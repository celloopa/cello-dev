---
interface Props {
	src: string;
	alt?: string;
	caption?: string;
}

const { src, alt = "", caption } = Astro.props;
const isVideo = src?.endsWith('.webm') || src?.endsWith('.mp4');
---

<div class="media-gallery media-full">
	<figure class="media-item">
		{isVideo ? (
			<video src={src} class="project-media" autoplay loop muted playsinline />
		) : (
			<img src={src} alt={alt} class="project-media" />
		)}
		{caption && <figcaption>{caption}</figcaption>}
	</figure>
</div>

<style>
	.media-gallery {
		margin: 2rem 0;
		animation: scaleIn 0.7s cubic-bezier(0.16, 1, 0.3, 1) backwards;
	}

	.media-full {
		display: block;
	}

	.media-item {
		margin: 0;
	}

	.media-item figcaption {
		font-size: 0.85rem;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.05em;
		color: var(--color-text);
		padding: 0.75rem 0;
		border-bottom: 2px solid var(--color-accent);
		margin: 0;
	}

	.project-media {
		width: 100%;
		border: 4px solid var(--color-text);
		filter: grayscale(20%);
		transition: filter 0.3s ease;
	}

	.media-full img.project-media {
		max-height: 600px;
		object-fit: cover;
	}

	.media-full video.project-media {
		height: auto;
		aspect-ratio: auto;
		max-height: none;
		object-fit: contain;
	}

	.project-media:hover {
		filter: grayscale(0%);
	}

	@keyframes scaleIn {
		from {
			opacity: 0;
			transform: scale(0.95);
		}
		to {
			opacity: 1;
			transform: scale(1);
		}
	}

	@media (width <= 700px) {
		.media-full img.project-media {
			max-height: 300px;
		}
	}
</style>
